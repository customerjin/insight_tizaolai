# ============================================================
# Macro Liquidity Daily Monitor - Configuration
# ============================================================

# FRED API Key (free: https://fred.stlouisfed.org/docs/api/api_key.html)
# Leave empty to use backup sources (higher latency, less coverage)
fred_api_key: "0a5a7aff1eca5a1753fed29cf53c5aca"

# ------------------------------------------------------------
# Data Sources - Core Indicators
# ------------------------------------------------------------
indicators:
  # --- Net Liquidity Components ---
  fed_total_assets:
    name: "Fed Total Assets"
    fred_id: "WALCL"
    frequency: "weekly"
    unit: "millions"
    category: "net_liquidity"

  tga_balance:
    name: "Treasury General Account"
    fred_id: "WTREGEN"
    frequency: "weekly"
    unit: "millions"
    category: "net_liquidity"

  on_rrp:
    name: "Overnight Reverse Repo"
    fred_id: "RRPONTSYD"
    frequency: "daily"
    unit: "billions"
    category: "net_liquidity"

  # --- Short-term Funding ---
  sofr:
    name: "SOFR"
    fred_id: "SOFR"
    frequency: "daily"
    unit: "percent"
    category: "funding_rate"

  # --- Credit ---
  hy_oas:
    name: "HY OAS (ICE BofA)"
    fred_id: "BAMLH0A0HYM2"
    frequency: "daily"
    unit: "percent"
    category: "credit"

  # --- Rates ---
  us2y:
    name: "US 2Y Yield"
    fred_id: "DGS2"
    frequency: "daily"
    unit: "percent"
    category: "rates"

  us10y:
    name: "US 10Y Yield"
    fred_id: "DGS10"
    frequency: "daily"
    unit: "percent"
    category: "rates"

  # --- Volatility ---
  vix:
    name: "VIX"
    fred_id: "VIXCLS"
    frequency: "daily"
    unit: "index"
    category: "volatility"

  # --- FX (FRED backup) ---
  usdjpy_fred:
    name: "USD/JPY (FRED)"
    fred_id: "DEXJPUS"
    frequency: "daily"
    unit: "jpy_per_usd"
    category: "fx"

# ------------------------------------------------------------
# Yahoo Finance Sources (no API key needed)
# ------------------------------------------------------------
yahoo_sources:
  usdjpy:
    name: "USD/JPY"
    ticker: "USDJPY=X"
    category: "fx"

  spx:
    name: "S&P 500"
    ticker: "^GSPC"
    category: "risk_asset"

  dxy:
    name: "US Dollar Index"
    ticker: "DX-Y.NYB"
    category: "fx"

  btc:
    name: "Bitcoin"
    ticker: "BTC-USD"
    category: "risk_asset"

# ------------------------------------------------------------
# Japan 2Y Yield (special handling)
# ------------------------------------------------------------
jp2y:
  name: "Japan 2Y Yield"
  fred_id: "IRLTST01JPM156N"  # Monthly, needs interpolation
  frequency: "monthly"
  fallback_rate: 0.5  # BOJ policy rate as floor anchor
  unit: "percent"

# ------------------------------------------------------------
# Signal Parameters
# ------------------------------------------------------------
signal:
  lookback_days: 252          # ~1 year for percentile/zscore
  change_windows: [1, 5, 20]  # 1d, 1w, 1m change
  zscore_window: 60           # Rolling zscore window
  percentile_window: 252      # Rolling percentile window

# ------------------------------------------------------------
# Judgment Rules Thresholds
# ------------------------------------------------------------
judgment:
  # Net liquidity weakening: 5d change < threshold (billions)
  net_liq_weak_threshold_5d: -50
  # SOFR stress: 5d change > threshold (bps)
  sofr_stress_threshold_5d: 5
  # VIX (MOVE proxy) stress: level > threshold
  vix_stress_threshold: 25
  # Carry trade stress: USDJPY 5d drop > threshold (yen)
  usdjpy_stress_threshold_5d: -2.0
  # US2Y-JP2Y spread narrowing: 5d change < threshold
  carry_spread_narrow_threshold_5d: -10
  # HY OAS widening: 5d change > threshold (bps)
  hy_oas_widen_threshold_5d: 15
  # Risk asset confirmation: SPX 5d return < threshold
  spx_weak_threshold_5d: -0.02
  # Minimum confirmations for "tightening" call
  min_confirmations: 2

# ------------------------------------------------------------
# Output
# ------------------------------------------------------------
output:
  base_dir: "output"
  chart_lookback_days: 252  # 1 year charts
  chart_dpi: 150
  chart_style: "seaborn-v0_8-darkgrid"

# ------------------------------------------------------------
# Cache
# ------------------------------------------------------------
cache:
  dir: "cache"
  max_age_hours: 12  # Re-fetch if cache older than this

# ------------------------------------------------------------
# Daily Brief Module (新增)
# ------------------------------------------------------------
daily_brief:
  # 行情标的
  market_indices:
    - symbol: "^NDX"
      name: "纳斯达克100"
      name_en: "Nasdaq 100"
      market: "US"
      timezone: "US/Eastern"
      trading_hours: {open: "09:30", close: "16:00"}
      currency: "USD"
    - symbol: "000300.SS"
      name: "沪深300"
      name_en: "CSI 300"
      market: "CN"
      timezone: "Asia/Shanghai"
      trading_hours: {open: "09:30", close: "15:00"}
      currency: "CNY"
    - symbol: "^HSTECH"
      name: "恒生科技"
      name_en: "Hang Seng Tech"
      market: "HK"
      timezone: "Asia/Hong_Kong"
      trading_hours: {open: "09:30", close: "16:00"}
      currency: "HKD"
    - symbol: "000001.SS"
      name: "上证指数"
      name_en: "SSE Composite"
      market: "CN"
      timezone: "Asia/Shanghai"
      trading_hours: {open: "09:30", close: "15:00"}
      currency: "CNY"
    - symbol: "BTC-USD"
      name: "比特币"
      name_en: "Bitcoin"
      market: "CRYPTO"
      timezone: "UTC"
      trading_hours: {open: "00:00", close: "23:59"}
      currency: "USD"

  # 明星股筛选
  movers:
    markets: ["US", "HK", "CN"]
    top_n: 10
    min_change_pct: 3.0

  # 新闻配置
  news:
    max_articles: 30
    top_n: 5
    finnhub_api_key: ""  # Optional: Get free key at finnhub.io

  # AI 解读 (可选，无 API Key 时自动降级为规则模板)
  analysis:
    provider: "none"       # "openai" / "anthropic" / "none"
    api_key: ""            # Or set ANALYSIS_API_KEY env var
    model: "gpt-4o-mini"   # Or claude-sonnet-4-5-20250929

  # 缓存 TTL (秒)
  cache:
    market_ttl: 300        # 行情缓存 5 分钟
    news_ttl: 1800         # 新闻缓存 30 分钟
    analysis_ttl: 3600     # 解读缓存 1 小时
    movers_ttl: 600        # 异动缓存 10 分钟

# ------------------------------------------------------------
# Logging
# ------------------------------------------------------------
logging:
  level: "INFO"
  dir: "output/logs"
