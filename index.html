<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>å®è§‚æµåŠ¨æ€§ä»ªè¡¨ç›˜</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"PingFang SC","Hiragino Sans GB","Microsoft YaHei",sans-serif;background:#0f172a;color:#e2e8f0;line-height:1.6;font-size:14px}
.container{max-width:1200px;margin:0 auto;padding:20px}

/* Loading */
.loading{display:flex;flex-direction:column;align-items:center;justify-content:center;height:80vh;gap:16px}
.loading-spinner{width:48px;height:48px;border:4px solid #334155;border-top-color:#3b82f6;border-radius:50%;animation:spin 0.8s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.loading-text{color:#94a3b8;font-size:14px}

/* ========== TAB NAVIGATION ========== */
.tab-nav{display:flex;gap:2px;background:#1e293b;border-radius:12px;padding:4px;margin-bottom:24px;border:1px solid #334155}
.tab-btn{flex:1;padding:10px 24px;border:none;background:transparent;color:#94a3b8;font-size:14px;font-weight:600;cursor:pointer;border-radius:8px;transition:all .2s;font-family:inherit;letter-spacing:0.3px}
.tab-btn:hover{color:#e2e8f0;background:rgba(255,255,255,0.04)}
.tab-btn.active{background:#3b82f6;color:#fff;box-shadow:0 2px 8px rgba(59,130,246,0.3)}
.tab-indicator{font-size:10px;margin-left:6px;opacity:0.7}

/* Header */
.header{display:flex;justify-content:space-between;align-items:center;padding:16px 0;border-bottom:1px solid #1e293b;margin-bottom:24px;flex-wrap:wrap;gap:12px}
.header h1{font-size:22px;font-weight:800;color:#f1f5f9;letter-spacing:-0.5px}
.header-meta{font-size:12px;color:#64748b}
.header-badge{display:inline-block;padding:2px 10px;background:#1e293b;border-radius:6px;font-size:11px;color:#94a3b8;margin-left:8px}

/* ========== BRIEF HERO ========== */
.brief-hero{background:linear-gradient(135deg,#1e293b 0%,#0f172a 50%,#172554 100%);border:1px solid #334155;border-radius:16px;padding:32px 28px;margin-bottom:24px;position:relative;overflow:hidden}
.brief-hero::before{content:"";position:absolute;top:-40%;right:-10%;width:300px;height:300px;background:radial-gradient(circle,rgba(59,130,246,0.08) 0%,transparent 70%);border-radius:50%}
.brief-hero-title{font-size:26px;font-weight:800;color:#f1f5f9;margin-bottom:6px;letter-spacing:-0.5px;position:relative}
.brief-hero-sub{font-size:13px;color:#94a3b8;margin-bottom:18px;line-height:1.6;position:relative}
.brief-hero-features{display:flex;flex-wrap:wrap;gap:8px;position:relative}
.brief-hero-tag{display:inline-flex;align-items:center;gap:5px;padding:5px 12px;background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.06);border-radius:8px;font-size:11px;color:#cbd5e1;font-weight:500;transition:border-color .2s}
.brief-hero-tag:hover{border-color:rgba(59,130,246,0.3)}

/* ========== DAILY BRIEF STYLES ========== */
.brief-status{display:flex;align-items:center;gap:16px;padding:12px 20px;background:#1e293b;border:1px solid #334155;border-radius:12px;margin-bottom:20px;flex-wrap:wrap}
.brief-date{font-size:16px;font-weight:700;color:#f1f5f9}
.brief-update{font-size:12px;color:#64748b}
.brief-badge{display:inline-flex;align-items:center;gap:4px;padding:3px 10px;border-radius:6px;font-size:11px;font-weight:600}
.brief-badge.ok{background:rgba(34,197,94,0.1);color:#86efac;border:1px solid rgba(34,197,94,0.2)}
.brief-badge.partial{background:rgba(234,179,8,0.1);color:#fcd34d;border:1px solid rgba(234,179,8,0.2)}
.brief-badge.error{background:rgba(239,68,68,0.1);color:#fca5a5;border:1px solid rgba(239,68,68,0.2)}

.market-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px;margin-bottom:24px}
.market-card{background:#1e293b;border:1px solid #334155;border-radius:14px;padding:16px 18px;transition:transform .15s,border-color .15s}
.market-card:hover{transform:translateY(-2px);border-color:#3b82f6}
.market-card-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.market-card-name{font-size:13px;font-weight:700;color:#f1f5f9}
.market-card-status{font-size:10px;padding:2px 6px;border-radius:4px}
.market-card-price{font-size:22px;font-weight:800;font-variant-numeric:tabular-nums;margin-bottom:4px}
.market-card-change{font-size:14px;font-weight:700;font-variant-numeric:tabular-nums}
.market-card-range{font-size:10px;color:#64748b;margin-top:4px}

.brief-section{margin-bottom:28px}
.brief-section-title{font-size:16px;font-weight:800;color:#f1f5f9;margin-bottom:14px;padding-bottom:8px;border-bottom:2px solid #334155;display:flex;align-items:center;gap:8px}
.brief-section-icon{font-size:18px}

.movers-grid{display:grid;grid-template-columns:1fr 1fr;gap:16px}
@media(max-width:768px){.movers-grid{grid-template-columns:1fr}}
.movers-panel{background:#1e293b;border:1px solid #334155;border-radius:14px;overflow:hidden}
.movers-header{padding:12px 16px;font-size:13px;font-weight:700;border-bottom:1px solid #334155}
.movers-header.gainers{background:rgba(34,197,94,0.06);color:#86efac}
.movers-header.losers{background:rgba(239,68,68,0.06);color:#fca5a5}
.mover-row{display:flex;align-items:center;padding:10px 16px;border-bottom:1px solid rgba(255,255,255,0.03);gap:10px;transition:background .1s}
.mover-row:hover{background:rgba(255,255,255,0.02)}
.mover-rank{width:20px;font-size:11px;color:#475569;font-weight:700}
.mover-info{flex:1;min-width:0}
.mover-name{font-size:13px;font-weight:600;color:#f1f5f9;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.mover-code{font-size:10px;color:#64748b}
.mover-change{font-size:14px;font-weight:800;font-variant-numeric:tabular-nums;min-width:65px;text-align:right}
.mover-reason{font-size:11px;color:#94a3b8;margin-top:2px;line-height:1.4}
.mover-reason a{color:#60a5fa;text-decoration:none}
.mover-reason a:hover{text-decoration:underline}
.mover-no-reason{font-size:11px;color:#475569;font-style:italic}

.event-list{display:flex;flex-direction:column;gap:8px}
.event-card{background:#1e293b;border:1px solid #334155;border-radius:12px;padding:14px 18px;transition:border-color .15s}
.event-card:hover{border-color:#3b82f6}
.event-rank{display:inline-flex;align-items:center;justify-content:center;width:22px;height:22px;border-radius:6px;background:#3b82f6;color:#fff;font-size:11px;font-weight:800;margin-right:8px;flex-shrink:0}
.event-title{font-size:14px;font-weight:600;color:#f1f5f9;line-height:1.4}
.event-meta{display:flex;gap:12px;margin-top:6px;flex-wrap:wrap;align-items:center}
.event-summary{font-size:12px;color:#94a3b8;margin-top:4px;line-height:1.5}
.event-tag{font-size:10px;padding:2px 8px;background:#0f172a;border-radius:4px;color:#64748b}
.event-source{font-size:11px;color:#64748b}
.event-source a{color:#60a5fa;text-decoration:none}
.event-source a:hover{text-decoration:underline}
.event-time{font-size:11px;color:#475569}

.commentary-box{background:#1e293b;border:1px solid #334155;border-radius:14px;padding:20px 24px}
.commentary-section{margin-bottom:16px}
.commentary-section:last-child{margin-bottom:0}
.commentary-label{font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:1px;margin-bottom:6px}
.commentary-label.theme{color:#60a5fa}
.commentary-label.risk{color:#fca5a5}
.commentary-label.watch{color:#fcd34d}
.commentary-text{font-size:14px;line-height:1.7;color:#cbd5e1}

.outlook-grid{display:flex;flex-direction:column;gap:12px}
.outlook-card{background:#1e293b;border:1px solid #334155;border-radius:14px;padding:18px 20px}
.outlook-header{display:flex;align-items:center;gap:10px;margin-bottom:10px}
.outlook-sector{font-size:15px;font-weight:700;color:#f1f5f9}
.outlook-dir{display:inline-block;padding:3px 10px;border-radius:6px;font-size:12px;font-weight:700}
.outlook-dir.bullish{background:rgba(34,197,94,0.1);color:#86efac;border:1px solid rgba(34,197,94,0.2)}
.outlook-dir.bearish{background:rgba(239,68,68,0.1);color:#fca5a5;border:1px solid rgba(239,68,68,0.2)}
.outlook-dir.neutral{background:rgba(234,179,8,0.1);color:#fcd34d;border:1px solid rgba(234,179,8,0.2)}
.outlook-body{font-size:13px;color:#94a3b8;line-height:1.6}
.outlook-logic{margin-bottom:6px}
.outlook-detail{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:8px}
@media(max-width:640px){.outlook-detail{grid-template-columns:1fr}}
.outlook-detail-box{padding:8px 12px;background:#0f172a;border-radius:8px;font-size:12px;line-height:1.5}
.outlook-detail-label{font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:0.5px;color:#64748b;margin-bottom:2px}
.outlook-stocks{display:flex;gap:6px;flex-wrap:wrap;margin-top:6px}
.outlook-stock-tag{font-size:11px;padding:2px 8px;background:rgba(59,130,246,0.1);border:1px solid rgba(59,130,246,0.2);color:#60a5fa;border-radius:4px;font-family:monospace}

.disclaimer{font-size:11px;color:#475569;padding:12px 16px;background:rgba(234,179,8,0.04);border:1px solid rgba(234,179,8,0.1);border-radius:8px;margin-top:20px;line-height:1.6;text-align:center}

/* ========== MACRO DASHBOARD STYLES ========== */
.score-hero{background:linear-gradient(135deg,#1e293b 0%,#0f172a 50%,#1e293b 100%);border:1px solid #334155;border-radius:20px;padding:32px;margin-bottom:24px;display:flex;gap:32px;flex-wrap:wrap}
.score-left{flex:0 0 240px;text-align:center;display:flex;flex-direction:column;align-items:center}
.score-label{font-size:11px;text-transform:uppercase;letter-spacing:2px;color:#64748b;margin-bottom:8px}
.score-number{font-size:80px;font-weight:900;line-height:1;letter-spacing:-4px;font-variant-numeric:tabular-nums}
.score-tier{display:inline-block;padding:6px 20px;border-radius:12px;font-size:16px;font-weight:800;margin-top:10px}
.score-right{flex:1;min-width:300px}
.advice-position{font-size:22px;font-weight:800;margin-bottom:8px}
.advice-detail{font-size:14px;line-height:1.8;color:#94a3b8;margin-bottom:16px}
.advice-action{font-size:13px;padding:8px 14px;background:rgba(255,255,255,0.04);border-radius:8px;border-left:3px solid #3b82f6;color:#cbd5e1;margin-bottom:6px}
.advice-risk{font-size:12px;color:#fca5a5;padding:6px 12px;background:rgba(239,68,68,0.08);border-radius:6px;margin-top:10px}
.advice-catalyst{font-size:12px;color:#86efac;padding:6px 12px;background:rgba(34,197,94,0.08);border-radius:6px;margin-top:6px}

.asset-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:16px;margin-bottom:24px}
.asset-card{background:#1e293b;border:1px solid #334155;border-radius:14px;padding:20px;display:flex;align-items:center;gap:16px}
.asset-icon{font-size:36px;width:52px;height:52px;display:flex;align-items:center;justify-content:center;background:#0f172a;border-radius:12px}
.asset-info{flex:1}
.asset-name{font-size:13px;color:#94a3b8;font-weight:600}
.asset-score-num{font-size:28px;font-weight:900;font-variant-numeric:tabular-nums}
.asset-tier-badge{display:inline-block;padding:2px 10px;border-radius:6px;font-size:11px;font-weight:700;margin-top:2px}
.asset-note{font-size:10px;color:#64748b;margin-top:4px;line-height:1.4}

.breakdown{background:#1e293b;border:1px solid #334155;border-radius:14px;padding:24px;margin-bottom:24px}
.breakdown-title{font-size:16px;font-weight:700;margin-bottom:4px}
.breakdown-sub{font-size:11px;color:#64748b;margin-bottom:16px}
.bar-row{display:flex;align-items:center;gap:10px;margin-bottom:8px}
.bar-label{width:110px;font-size:12px;font-weight:600;color:#94a3b8;text-align:right;flex-shrink:0}
.bar-weight{font-size:10px;color:#475569;margin-left:4px}
.bar-track{flex:1;height:22px;background:#0f172a;border-radius:11px;overflow:hidden;position:relative}
.bar-fill{height:100%;border-radius:11px;transition:width 1s ease-out}
.bar-val{width:36px;font-size:14px;font-weight:800;text-align:right;font-variant-numeric:tabular-nums}
.bar-signal{width:32px;font-size:11px;font-weight:700;text-align:center}

.factors{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-top:18px;padding-top:18px;border-top:1px solid #334155}
.factors-title{font-size:12px;font-weight:700;margin-bottom:6px}
.factor-item{font-size:12px;padding:3px 0;color:#cbd5e1}

.section-divider{font-size:18px;font-weight:800;color:#f1f5f9;margin:32px 0 16px;padding-bottom:8px;border-bottom:2px solid #334155;letter-spacing:-0.3px}

.judgment{background:#1e293b;border:1px solid #334155;border-radius:14px;padding:20px 24px;margin-bottom:24px}
.judgment-regime{display:inline-block;padding:6px 16px;border-radius:10px;font-size:16px;font-weight:800;margin-bottom:10px}
.judgment-text{font-size:14px;line-height:1.7;color:#cbd5e1}
.judgment-tags{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
.judgment-tag{padding:3px 10px;background:#0f172a;border-radius:6px;font-size:11px;color:#94a3b8}

.table-wrap{background:#1e293b;border:1px solid #334155;border-radius:14px;overflow:hidden;margin-bottom:24px}
table{width:100%;border-collapse:collapse;font-size:12px}
th{background:#0f172a;padding:10px 12px;text-align:left;font-weight:600;font-size:10px;text-transform:uppercase;letter-spacing:0.8px;color:#64748b;border-bottom:2px solid #334155}
td{padding:9px 12px;border-bottom:1px solid #1e293b}
tr:hover{background:rgba(255,255,255,0.02)}
.num{text-align:right;font-variant-numeric:tabular-nums;font-family:"SF Mono",Monaco,"Fira Code",monospace}
.signal-badge{display:inline-block;padding:2px 8px;border-radius:8px;font-size:10px;font-weight:700}

.indicator{background:#1e293b;border:1px solid #334155;border-radius:14px;padding:24px;margin-bottom:20px}
.indicator-header{display:flex;align-items:center;gap:14px;margin-bottom:16px}
.indicator-num{width:32px;height:32px;border-radius:50%;background:#3b82f6;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:14px;flex-shrink:0}
.indicator-title{font-size:16px;font-weight:700}
.indicator-val{font-size:12px;color:#64748b;margin-top:2px}
.indicator-chart{margin-bottom:16px;border-radius:8px;overflow:hidden}
.indicator-chart img{width:100%;display:block}
.explain-what{margin-bottom:12px}
.explain-label{font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:0.8px;color:#64748b;margin-bottom:4px}
.explain-text{font-size:13px;line-height:1.7;color:#94a3b8}
.explain-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px}
.explain-good{padding:12px;background:rgba(16,185,129,0.06);border-left:3px solid #10b981;border-radius:0 8px 8px 0}
.explain-bad{padding:12px;background:rgba(239,68,68,0.06);border-left:3px solid #ef4444;border-radius:0 8px 8px 0}

.quality{background:#1e293b;border:1px solid #334155;border-radius:14px;padding:20px 24px;margin-bottom:24px}
.nav-bar{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:24px}
.nav-link{display:inline-block;padding:5px 14px;background:#1e293b;border:1px solid #334155;border-radius:8px;font-size:11px;color:#94a3b8;text-decoration:none;cursor:pointer;transition:all .15s}
.nav-link:hover{background:#334155;color:#f1f5f9}

.footer{text-align:center;padding:24px 0;font-size:11px;color:#475569;border-top:1px solid #1e293b;margin-top:32px}
.note{font-size:11px;color:#475569;padding:8px 12px;background:#0f172a;border-radius:6px;margin-top:8px;line-height:1.6}

/* ========== FORWARD ANALYSIS ========== */
.fwd-panel{background:#1e293b;border:1px solid #334155;border-radius:14px;padding:20px 24px;margin-bottom:20px}
.fwd-title{font-size:16px;font-weight:700;color:#f1f5f9;margin-bottom:4px}
.fwd-subtitle{font-size:11px;color:#64748b;margin-bottom:16px}
.fwd-empty{color:#475569;font-size:13px;padding:16px 0}
.fwd-empty-section .fwd-panel{margin-top:0}

.trend-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:12px}
.trend-card{background:#0f172a;border-radius:10px;padding:12px 16px;border:1px solid #1e293b}
.trend-name{font-size:13px;font-weight:700;color:#e2e8f0;margin-bottom:6px}
.trend-dir{display:flex;align-items:center;gap:6px;margin-bottom:4px}
.trend-label{font-size:12px}
.trend-nums{font-size:11px;color:#94a3b8;margin-bottom:2px}
.trend-verdict{font-size:11px;font-weight:600}

.sim-badge{background:#334155;padding:2px 8px;border-radius:10px;font-size:11px;font-weight:600}
.analogue-stats{margin-top:16px;padding:16px;background:#0f172a;border-radius:10px;border:1px solid #1e293b}
.stat-row{display:flex;align-items:center;gap:12px;padding:6px 0;font-size:13px;color:#cbd5e1}
.stat-label{font-weight:700;min-width:120px}
.stat-val{color:#94a3b8}

.fwd-signal-hero{display:flex;gap:32px;background:#1e293b;border:2px solid #334155;border-radius:16px;padding:24px 32px;margin-bottom:20px;flex-wrap:wrap}
.fwd-signal-left{text-align:center;min-width:160px}
.fwd-signal-label{font-size:12px;color:#64748b;text-transform:uppercase;letter-spacing:1px;margin-bottom:4px}
.fwd-signal-score{font-size:56px;font-weight:900;line-height:1.1}
.fwd-signal-bias{display:inline-block;padding:4px 16px;border-radius:20px;font-size:14px;font-weight:700;margin-top:8px}
.fwd-signal-right{flex:1;min-width:280px}
.fwd-comp{display:flex;flex-direction:column;gap:8px}
.fwd-comp-item{display:flex;align-items:center;gap:10px}
.fwd-comp-label{font-size:12px;color:#94a3b8;min-width:70px}
.fwd-comp-bar{flex:1;height:8px;background:#0f172a;border-radius:4px;overflow:hidden}
.fwd-comp-bar div{height:100%;border-radius:4px;transition:width .3s}
.fwd-comp-val{font-size:13px;font-weight:700;color:#cbd5e1;min-width:28px;text-align:right}
.regime-probs{display:flex;gap:16px;font-size:12px;font-weight:600}
.regime-prob{padding:4px 12px;background:#0f172a;border-radius:8px}

.fwd-narrative{background:#1e293b;border:1px solid #334155;border-radius:14px;padding:24px 28px;margin-bottom:20px}
.narrative-body{margin-top:12px}
.narrative-para{font-size:14px;line-height:1.8;color:#cbd5e1;margin-bottom:12px;text-indent:2em}
.narrative-disclaimer{font-size:11px;color:#475569;margin-top:16px;padding-top:12px;border-top:1px solid #1e293b}

@media(max-width:768px){
  .score-hero{padding:20px}
  .score-left{flex:0 0 auto;width:100%}
  .score-number{font-size:64px}
  .explain-grid{grid-template-columns:1fr}
  .factors{grid-template-columns:1fr}
  .bar-label{width:80px;font-size:11px}
  .market-grid{grid-template-columns:repeat(auto-fit,minmax(150px,1fr))}
  .market-card-price{font-size:18px}
  .tab-btn{font-size:12px;padding:8px 12px}
}
</style>
</head>
<body>
<div id="root"></div>

<script type="text/babel">
const { useState, useEffect } = React;

// ============================================================
// MACRO DASHBOARD - Knowledge & Constants (unchanged)
// ============================================================
const KNOWLEDGE = {
  net_liquidity:{title:"å‡€æµåŠ¨æ€§ (Net Liquidity)",what:"è¡¡é‡ç¾è”å‚¨å®é™…å‘é‡‘èä½“ç³»é‡Šæ”¾äº†å¤šå°‘å¯ç”¨æµåŠ¨æ€§ã€‚å…¬å¼ï¼šFedæ€»èµ„äº§ - TGA - ON RRPã€‚",high:"é‡‘èä½“ç³»æ°´ä½å……è£•ï¼Œé“¶è¡Œé—´èµ„é‡‘å®½æ¾ï¼Œé£é™©èµ„äº§å€¾å‘è·å¾—æ”¯æ’‘ã€‚",low:"ç³»ç»Ÿæ€§æµåŠ¨æ€§æ”¶ç´§ï¼Œé“¶è¡Œå‡†å¤‡é‡‘ä¸‹é™ï¼Œèµ„é‡‘æˆæœ¬ä¸Šå‡å‹åŠ›å¢å¤§ã€‚",chart:"net_liquidity"},
  composite:{title:"å‡€æµåŠ¨æ€§ vs S&P 500",what:"å°†å‡€æµåŠ¨æ€§ä¸æ ‡æ™®500å åŠ å¯¹æ¯”ï¼ŒéªŒè¯'æµåŠ¨æ€§é©±åŠ¨é£é™©åå¥½'çš„æ ¸å¿ƒé€»è¾‘ã€‚",high:"ä¸¤è€…åŒæ­¥ä¸Šè¡Œ = æµåŠ¨æ€§é©±åŠ¨çš„å¥åº·ç‰›å¸‚ã€‚",low:"ä¸¤è€…èƒŒç¦» = æµåŠ¨æ€§åŸºç¡€æ¾åŠ¨ï¼Œé£é™©èµ„äº§å¯èƒ½æ»åååº”ã€‚",chart:"composite_netliq_spx"},
  sofr:{title:"SOFR",what:"ç¾å›½çŸ­æœŸèµ„é‡‘å¸‚åœºåŸºå‡†åˆ©ç‡ã€‚",high:"èèµ„æˆæœ¬ä¸Šå‡ï¼Œå¯¹æ æ†ç­–ç•¥ä¸åˆ©ã€‚",low:"èµ„é‡‘é¢å®½æ¾ï¼Œæœ‰åˆ©äºæ æ†ç­–ç•¥ã€‚",chart:"sofr"},
  move_proxy:{title:"åˆ©ç‡æ³¢åŠ¨ä»£ç† (MOVE Proxy)",what:"ç”¨VIX Ã— å›½å€ºåˆ©ç‡æ³¢åŠ¨ç‡æ„å»ºã€‚",high:"å€ºå¸‚ææ…ŒåŠ å‰§ï¼Œå¯èƒ½ä¼ å¯¼è‡³é£é™©èµ„äº§ã€‚",low:"åˆ©ç‡å¸‚åœºå¹³é™ï¼Œæœ‰åˆ©äºcarryç­–ç•¥ã€‚",chart:"move_proxy"},
  hy_oas:{title:"é«˜æ”¶ç›Šä¿¡ç”¨åˆ©å·® (HY OAS)",what:"é«˜æ”¶ç›Šå€ºç›¸å¯¹å›½å€ºçš„ä»·å·®ã€‚",high:"ä¿¡ç”¨å¸‚åœºå®šä»·è¿çº¦é£é™©ä¸Šå‡ã€‚",low:"ä¿¡ç”¨å¸‚åœºä¹è§‚ï¼Œèèµ„ç¯å¢ƒå‹å¥½ã€‚",chart:"hy_oas"},
  usdjpy:{title:"USD/JPY",what:"å…¨çƒå¥—æ¯äº¤æ˜“é£å‘æ ‡ã€‚",high:"æ—¥å…ƒå¼±ã€å¥—æ¯ç›ˆåˆ©æ‰©å¤§ã€Risk-Onã€‚",low:"æ—¥å…ƒèµ°å¼ºã€å¥—æ¯å¹³ä»“ã€å»æ æ†å‹åŠ›ã€‚",chart:"usdjpy"},
  carry_spread:{title:"å¥—æ¯åˆ©å·® (US 2Y - JP 2Y)",what:"è¡¡é‡å¥—æ¯äº¤æ˜“çš„åˆ©å·®åŸºç¡€ã€‚",high:"å¥—æ¯æœ‰å¼ºåˆ©å·®æ”¯æ’‘ã€‚",low:"å¥—æ¯åŠ¨åŠ›è¡°å‡ã€‚",chart:"carry_spread_bps"},
  curve_slope:{title:"æ”¶ç›Šç‡æ›²çº¿æ–œç‡ (10Y - 2Y)",what:"ç»æµå‘¨æœŸå‰ç»æŒ‡æ ‡ã€‚",high:"å¸‚åœºé¢„æœŸç»æµå‘å¥½ã€‚",low:"å¸‚åœºé¢„æœŸç»æµæ”¾ç¼“æˆ–è¡°é€€ã€‚",chart:"curve_slope_bps"},
  vix:{title:"VIX (ææ…ŒæŒ‡æ•°)",what:"æ ‡æ™®500æœŸæƒéšå«æ³¢åŠ¨ç‡ã€‚",high:"å¸‚åœºææ…ŒåŠ å‰§ã€‚",low:"å¸‚åœºæåº¦å¹³é™ã€‚",chart:"vix"},
  spx:{title:"S&P 500",what:"å…¨çƒé£é™©èµ„äº§çš„é”šã€‚",high:"é£é™©åå¥½å¼ºåŠ²ã€‚",low:"é£é™©åå¥½æ¶åŒ–ã€‚",chart:"spx"},
  dxy:{title:"ç¾å…ƒæŒ‡æ•° (DXY)",what:"ç¾å…ƒå¯¹ä¸€ç¯®å­è´§å¸çš„åŠ æƒæŒ‡æ•°ã€‚",high:"å…¨çƒç¾å…ƒæµåŠ¨æ€§ç´§ç¼©ã€‚",low:"ç¾å…ƒæµåŠ¨æ€§å¤–æº¢ï¼Œå…¨çƒRisk-Onã€‚",chart:"dxy"},
  btc:{title:"Bitcoin (BTC/USD)",what:"å‡€æµåŠ¨æ€§çš„æ æ†ç‰ˆæœ¬ã€‚",high:"æµåŠ¨æ€§æåº¦å……è£•ã€‚",low:"æµåŠ¨æ€§æ”¶ç´§çš„'çŸ¿äº•é‡‘ä¸é›€'ã€‚",chart:"btc"},
};
const SECTION_ORDER=["net_liquidity","composite","sofr","move_proxy","hy_oas","usdjpy","carry_spread","curve_slope","vix","spx","dxy","btc"];
const IND_NAME={net_liquidity:"å‡€æµåŠ¨æ€§",vix:"VIXææ…ŒæŒ‡æ•°",hy_oas:"é«˜æ”¶ç›Šä¿¡ç”¨åˆ©å·®",sofr:"SOFRèµ„é‡‘åˆ©ç‡",dxy:"ç¾å…ƒæŒ‡æ•°",carry_spread_bps:"å¥—æ¯åˆ©å·®",curve_slope_bps:"æ”¶ç›Šç‡æ›²çº¿",on_rrp:"é€†å›è´­(RRP)"};
const DATA_KEY_MAP={net_liquidity:"net_liquidity",composite:"spx",sofr:"sofr",move_proxy:"move_proxy",hy_oas:"hy_oas",usdjpy:"usdjpy",carry_spread:"carry_spread_bps",curve_slope:"curve_slope_bps",vix:"vix",spx:"spx",dxy:"dxy",btc:"btc"};
const METRIC_DEFS=[["net_liquidity","å‡€æµåŠ¨æ€§","B",1],["sofr","SOFR","%",4],["hy_oas","HY OAS","%",2],["move_proxy","MOVE Proxy","",1],["vix","VIX","",1],["usdjpy","USD/JPY","",1],["carry_spread_bps","å¥—æ¯åˆ©å·®","bps",0],["curve_slope_bps","æ›²çº¿æ–œç‡","bps",0],["spx","S&P 500","",0],["btc","Bitcoin","$",0],["dxy","DXY","",1],["us2y","US 2Y","%",3],["us10y","US 10Y","%",3]];
const BAD_WHEN_UP=new Set(["sofr","hy_oas","vix","move_proxy","dxy"]);
const PCT_IND=new Set(["spx","btc","usdjpy","dxy"]);

// ============================================================
// DAILY BRIEF COMPONENTS
// ============================================================
function BriefStatusBar({brief}){
  // Real validation: check actual data presence
  const indices=brief.market?.indices||[];
  const hasMarket=indices.some(i=>i.price!=null);
  const hasMovers=(brief.movers?.gainers||[]).length>0||(brief.movers?.losers||[]).length>0;
  const hasNews=(brief.news?.top5||brief.news?.events||[]).length>0;
  const checks=[hasMarket,hasMovers,hasNews];
  const okCount=checks.filter(Boolean).length;
  let cls,label;
  if(okCount===3){cls="ok";label="âœ“ æ•°æ®æ­£å¸¸";}
  else if(okCount>0){cls="partial";label="âš  éƒ¨åˆ†æ•°æ®å¯ç”¨ ("+okCount+"/3)";}
  else{cls="error";label="âœ— æ•°æ®è·å–å¤±è´¥";}
  return(<div className="brief-status"><div className="brief-date">{brief.date||new Date().toLocaleDateString('zh-CN')}</div><div className="brief-update">æ›´æ–°äº {brief.update_time||"--:--"}</div><div className={`brief-badge ${cls}`}>{label}</div></div>);
}

function DataErrorBox({title,status,errorDetail,hints}){
  return(<div style={{background:"#1e1a2e",border:"1px solid #4c1d95",borderRadius:12,padding:"20px 24px",marginBottom:16}}><div style={{display:"flex",alignItems:"center",gap:8,marginBottom:10}}><span style={{fontSize:18}}>âš ï¸</span><span style={{fontSize:14,fontWeight:700,color:"#c4b5fd"}}>{title}</span><span style={{fontSize:11,padding:"2px 8px",background:"rgba(239,68,68,0.15)",color:"#fca5a5",borderRadius:4}}>{status}</span></div>{errorDetail&&<div style={{fontSize:12,color:"#a78bfa",background:"rgba(0,0,0,0.3)",padding:"8px 12px",borderRadius:6,marginBottom:10,fontFamily:"monospace",wordBreak:"break-all"}}>{errorDetail}</div>}<div style={{fontSize:12,color:"#94a3b8",lineHeight:1.8}}>{hints.map((h,i)=><div key={i}>{h}</div>)}</div></div>);
}

function MarketCards({market}){
  const allIndices=market?.indices||[];
  const indices=allIndices.filter(i=>i.price!=null);
  if(!indices.length){
    const err=market?.error_detail||allIndices.find(i=>i.error)?.error||"";
    const errLower=(err+"").toLowerCase();
    let hints=[];
    if(errLower.includes("timeout")||errLower.includes("connect")){hints=["â†’ ç½‘ç»œè¿æ¥è¶…æ—¶ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–VPNçŠ¶æ€","â†’ ç»ˆç«¯æµ‹è¯•: curl -I https://query2.finance.yahoo.com","â†’ æ‰§è¡Œ ./deploy.sh --brief-only é‡æ–°è·å–"];}
    else if(errLower.includes("401")||errLower.includes("403")||errLower.includes("consent")){hints=["â†’ Yahoo Finance API é‰´æƒå¤±è´¥","â†’ å°è¯•åœ¨æµè§ˆå™¨è®¿é—® finance.yahoo.com å¹¶åŒæ„ cookie å¼¹çª—åé‡è¯•","â†’ æ‰§è¡Œ ./deploy.sh --brief-only é‡æ–°è·å–"];}
    else if(errLower.includes("json")||errLower.includes("decode")){hints=["â†’ è¿”å›å†…å®¹ä¸æ˜¯æœ‰æ•ˆJSONï¼Œå¯èƒ½è¢«é˜²ç«å¢™/ä»£ç†æ‹¦æˆª","â†’ æ£€æŸ¥æ˜¯å¦æœ‰å…¬å¸VPNæˆ–é˜²ç«å¢™è§„åˆ™","â†’ æ‰§è¡Œ ./deploy.sh --brief-only é‡æ–°è·å–"];}
    else{hints=["â†’ Yahoo Finance API è¯·æ±‚å¤±è´¥","â†’ ä¸­å›½å¤§é™†å¯èƒ½éœ€è¦ä»£ç†/VPNæ‰èƒ½è®¿é—®","â†’ ä¹Ÿå¯èƒ½æ˜¯ Yahoo API ä¸´æ—¶æ•…éšœï¼Œç¨åé‡è¯•","â†’ ç¡®è®¤èƒ½è®¿é—® finance.yahoo.com åæ‰§è¡Œ ./deploy.sh --brief-only"];}
    return <DataErrorBox title="è¡Œæƒ…æ•°æ®è·å–å¤±è´¥" status={market?.status_text||"error"} errorDetail={err||"Yahoo Finance API æœªè¿”å›æœ‰æ•ˆæ•°æ®"} hints={hints}/>;
  }
  return(<div className="market-grid">{indices.map(idx=>{const sc=idx.status_color||idx.trading_status_color||"#64748b";const dr=idx.day_range||idx.range_display;return(<div className="market-card" key={idx.symbol}><div className="market-card-header"><div className="market-card-name">{idx.name}</div><div className="market-card-status" style={{background:sc+"20",color:sc}}>{idx.trading_status}</div></div><div className="market-card-price" style={{color:idx.change_color||"#e2e8f0"}}>{idx.price_display||"N/A"}</div><div className="market-card-change" style={{color:idx.change_color||"#94a3b8"}}>{idx.change_display||"N/A"}</div>{dr&&<div className="market-card-range">æ—¥å†…: {dr}</div>}</div>);})}</div>);
}

function MoversPanel({movers}){
  const gainers=movers?.gainers||[]; const losers=movers?.losers||[];
  if(gainers.length===0&&losers.length===0&&movers?.status==="error"){
    return <DataErrorBox title="æ˜æ˜Ÿè‚¡å¼‚åŠ¨è·å–å¤±è´¥" status="ä¾èµ–è¡Œæƒ…æ•°æ®" errorDetail="æ˜æ˜Ÿè‚¡å¼‚åŠ¨è¿½è¸ªä¾èµ– Yahoo Finance è¡Œæƒ…æ¥å£ï¼Œè¡Œæƒ…æ•°æ®è·å–å¤±è´¥æ—¶å¼‚åŠ¨ä¹Ÿæ— æ³•ç”Ÿæˆã€‚" hints={["â†’ è§£å†³ä¸Šæ–¹è¡Œæƒ…æ•°æ®é—®é¢˜åï¼Œå¼‚åŠ¨æ•°æ®å°†è‡ªåŠ¨æ¢å¤","â†’ æ˜æ˜Ÿè‚¡è¦†ç›–: ç¾è‚¡20åªã€æ¸¯è‚¡12åªã€Aè‚¡10åª","â†’ å¼‚åŠ¨é˜ˆå€¼: æ—¥æ¶¨è·Œå¹… â‰¥3% æ‰ä¼šå±•ç¤º"]}/>;
  }
  const getReason=(s)=>{const r=s.reason;if(!r)return{text:null,url:null};if(typeof r==="string")return{text:r!=="æš‚æ— å¯é åŸå› "?r:null,url:s.news_url||null,source:null};return{text:r.text&&r.text!=="æš‚æ— å¯é åŸå› "?r.text:null,url:r.url||null,source:r.source||null};};
  const renderList=(items,type)=>(<div className="movers-panel"><div className={`movers-header ${type}`}>{type==="gainers"?"ğŸ”¥ æ¶¨å¹…æ¦œ":"ğŸ’§ è·Œå¹…æ¦œ"} ({items.length})</div>{items.length===0?(<div style={{padding:16,textAlign:"center",color:"#475569",fontSize:12}}>æš‚æ— æ˜¾è‘—å¼‚åŠ¨ (é˜ˆå€¼ Â±3%)</div>):items.map((s,i)=>{const reason=getReason(s);return(<div className="mover-row" key={s.symbol}><div className="mover-rank">{i+1}</div><div className="mover-info"><div className="mover-name">{s.name}</div><div className="mover-code">{s.symbol} Â· {s.market}</div>{reason.text?(<div className="mover-reason">{reason.text}{reason.url&&<>{" Â· "}<a href={reason.url} target="_blank" rel="noopener">{reason.source||"æ¥æº"}</a></>}</div>):(<div className="mover-no-reason">æš‚æ— å¯é åŸå› </div>)}</div><div className="mover-change" style={{color:type==="gainers"?"#86efac":"#fca5a5"}}>{(s.change_pct||0)>0?"+":""}{(s.change_pct||0).toFixed(1)}%</div></div>);})}</div>);
  return(<div className="movers-grid">{renderList(gainers,"gainers")}{renderList(losers,"losers")}</div>);
}

function EventsList({news}){
  const top5=news?.top5||news?.events||[];
  if(!top5.length) return <div style={{color:"#475569",textAlign:"center",padding:20}}>æš‚æ— é‡è¦äº‹ä»¶</div>;
  return(<div className="event-list">{top5.map((evt,i)=>(<div className="event-card" key={evt.rank||i}><div style={{display:"flex",alignItems:"flex-start"}}><span className="event-rank">{evt.rank||i+1}</span><div style={{flex:1}}><div className="event-title">{evt.title}</div>{evt.summary&&evt.summary!==evt.title&&<div className="event-summary">{evt.summary}</div>}<div className="event-meta">{(evt.impact_sectors||[]).map(s=><span className="event-tag" key={s}>{s}</span>)}<span className="event-time">{evt.published||evt.time||""}</span>{evt.url&&<span className="event-source"><a href={evt.url} target="_blank" rel="noopener">{evt.source||"æ¥æºé“¾æ¥"}</a></span>}</div></div></div></div>))}</div>);
}

function CommentaryBox({analysis}){
  const c=analysis?.commentary||{};
  return(<div className="commentary-box"><div className="commentary-section"><div className="commentary-label theme">ä»Šæ—¥ä¸»çº¿</div><div className="commentary-text">{c.main_theme||"æš‚æ— è§£è¯»"}</div></div><div className="commentary-section"><div className="commentary-label risk">é£é™©ç‚¹</div><div className="commentary-text">{c.risk_points||"æš‚æ— "}</div></div><div className="commentary-section"><div className="commentary-label watch">è§‚å¯Ÿç‚¹</div><div className="commentary-text">{c.watch_next||"æš‚æ— "}</div></div>{analysis?.source&&<div style={{fontSize:10,color:"#475569",marginTop:12,textAlign:"right"}}>åˆ†ææ¥æº: {analysis.source}</div>}</div>);
}

function OutlookPanel({analysis}){
  const outlook=analysis?.outlook||[];
  if(!outlook.length) return <div style={{color:"#475569",textAlign:"center",padding:20}}>æš‚æ— æŠ•èµ„åŠ¨å‘åˆ†æ</div>;
  const dirClass=d=>{if(d?.includes("å¤š"))return"bullish";if(d?.includes("ç©º"))return"bearish";return"neutral";};
  return(<div className="outlook-grid">{outlook.map((o,i)=>{const sector=o.sector||o.asset||"æœªçŸ¥";const logic=o.logic||(o.reason?[o.reason]:[]);return(<div className="outlook-card" key={i}><div className="outlook-header"><div className="outlook-sector">{sector}</div><div className={`outlook-dir ${dirClass(o.direction)}`}>{o.direction}</div></div><div className="outlook-body"><div className="outlook-logic">{logic.map((l,j)=><div key={j}>â€¢ {l}</div>)}</div>{o.watch_stocks?.length>0&&<div className="outlook-stocks">{o.watch_stocks.map(s=><span className="outlook-stock-tag" key={s}>{s}</span>)}</div>}<div className="outlook-detail"><div className="outlook-detail-box"><div className="outlook-detail-label">è§¦å‘æ¡ä»¶</div>{o.trigger||"å¾…è§‚å¯Ÿ"}</div><div className="outlook-detail-box"><div className="outlook-detail-label">é£é™©ç‚¹</div>{o.risk||"æš‚æ— "}</div></div></div></div>);})}</div>);
}

function BriefHero(){
  return(<div className="brief-hero"><div className="brief-hero-title">Insight Â· æ¯æ—¥æŠ•ç ”ç®€æŠ¥</div><div className="brief-hero-sub">è‡ªåŠ¨èšåˆå…¨çƒå¸‚åœºè¡Œæƒ…ã€æ˜æ˜Ÿè‚¡å¼‚åŠ¨ã€çƒ­ç‚¹äº‹ä»¶ä¸ AI è§£è¯»ï¼Œæ¯å¤© 8:00 æ›´æ–°ï¼ŒåŠ©ä½ å¿«é€ŸæŒæ¡æŠ•èµ„è„‰æã€‚</div><div className="brief-hero-features"><span className="brief-hero-tag">ğŸ“ˆ äº”å¤§æŒ‡æ•°å®æ—¶è¡Œæƒ…</span><span className="brief-hero-tag">ğŸ”¥ æ˜æ˜Ÿè‚¡æ¶¨è·Œè¿½è¸ª</span><span className="brief-hero-tag">ğŸ“° Top 5 æŠ•èµ„äº‹ä»¶</span><span className="brief-hero-tag">ğŸ¤– AI è¡Œæƒ…è§£è¯»</span><span className="brief-hero-tag">ğŸ§­ æŠ•èµ„æ–¹å‘å»ºè®®</span><span className="brief-hero-tag">ğŸ“Š å®è§‚æµåŠ¨æ€§è¯„åˆ†</span></div></div>);
}

function DailyBriefTab({brief}){
  if(!brief||brief.status==='unavailable') return(<div><BriefHero/><div style={{textAlign:"center",padding:"60px 20px",color:"#64748b"}}><div style={{fontSize:48,marginBottom:16}}>ğŸ“Š</div><div style={{fontSize:16,marginBottom:8}}>æ¯æ—¥åˆ†ææ•°æ®æš‚æœªç”Ÿæˆ</div><div style={{fontSize:12}}>è¯·è¿è¡Œ <code style={{color:"#60a5fa"}}>python run_daily.py</code> ç”Ÿæˆæœ€æ–°æ•°æ®</div></div></div>);
  return(<div>
    <BriefHero/>
    <BriefStatusBar brief={brief}/>
    <div className="brief-section"><div className="brief-section-title"><span className="brief-section-icon">ğŸ“ˆ</span> ä¸»è¦å¸‚åœºè¡¨ç°</div><MarketCards market={brief.market}/></div>
    <div className="brief-section"><div className="brief-section-title"><span className="brief-section-icon">ğŸ”¥</span> æ˜æ˜Ÿè‚¡å¼‚åŠ¨</div><MoversPanel movers={brief.movers}/></div>
    <div className="brief-section"><div className="brief-section-title"><span className="brief-section-icon">ğŸ“°</span> æŠ•èµ„åœˆå¤§äº‹ä»¶ Top 5</div><EventsList news={brief.news}/></div>
    <div className="brief-section"><div className="brief-section-title"><span className="brief-section-icon">ğŸ“Š</span> è¡Œæƒ…è§£è¯»</div><CommentaryBox analysis={brief.analysis}/></div>
    <div className="brief-section"><div className="brief-section-title"><span className="brief-section-icon">ğŸ§­</span> æŠ•èµ„åŠ¨å‘ä¸æœºä¼šæ–¹å‘</div><OutlookPanel analysis={brief.analysis}/></div>
    <div className="disclaimer">{brief.disclaimer||"ä»¥ä¸Šå†…å®¹ä¸ºä¿¡æ¯æ•´ç†ä¸ç ”ç©¶è¾…åŠ©ï¼Œä¸æ„æˆæŠ•èµ„å»ºè®®ã€‚å¸‚åœºæœ‰é£é™©ï¼ŒæŠ•èµ„éœ€è°¨æ…ã€‚"}</div>
  </div>);
}

// ============================================================
// MACRO DASHBOARD COMPONENTS (preserved)
// ============================================================
function SignalBadge({sig}){const map={STRESS:{icon:"ğŸ”´",bg:"#451a1a",color:"#fca5a5"},TIGHT:{icon:"ğŸŸ¡",bg:"#422006",color:"#fcd34d"},EASING:{icon:"ğŸŸ¢",bg:"#052e16",color:"#86efac"},NEUTRAL:{icon:"âšª",bg:"#1e293b",color:"#94a3b8"}};const s=map[sig]||map.NEUTRAL;return <span className="signal-badge" style={{background:s.bg,color:s.color}}>{s.icon} {sig}</span>;}

function GaugeSVG({score,color}){const cx=120,cy=120,r=90;const angle=-135+(score/100)*270;const rad=a=>a*Math.PI/180;const px=a=>cx+r*Math.cos(rad(a));const py=a=>cy+r*Math.sin(rad(a));const nl=75;const nx=cx+nl*Math.cos(rad(angle));const ny=cy+nl*Math.sin(rad(angle));const arcs=[{s:-135,e:-90,c:"#991b1b"},{s:-90,e:-45,c:"#ef4444"},{s:-45,e:0,c:"#eab308"},{s:0,e:45,c:"#22c55e"},{s:45,e:135,c:"#16a34a"}];return(<svg viewBox="0 0 240 160" style={{width:220,height:150,marginTop:8}}>{arcs.map((a,i)=><path key={i} d={`M ${px(a.s)} ${py(a.s)} A ${r} ${r} 0 0 1 ${px(a.e)} ${py(a.e)}`} fill="none" stroke={a.c} strokeWidth="14" opacity="0.35" strokeLinecap={i===0?"round":i===4?"round":"butt"}/>)}<line x1={cx} y1={cy} x2={nx.toFixed(1)} y2={ny.toFixed(1)} stroke={color} strokeWidth="3" strokeLinecap="round"/><circle cx={cx} cy={cy} r="5" fill={color}/><text x="32" y="142" fontSize="9" fill="#64748b">0</text><text x="112" y="22" fontSize="9" fill="#64748b" textAnchor="middle">50</text><text x="202" y="142" fontSize="9" fill="#64748b">100</text></svg>);}

function ScoreHero({data}){const{score,advice}=data;return(<div className="score-hero"><div className="score-left"><div className="score-label">å®è§‚æµåŠ¨æ€§ç»¼åˆè¯„åˆ†</div><div className="score-number" style={{color:score.tier_color}}>{score.composite}</div><div className="score-tier" style={{background:score.tier_color+"18",color:score.tier_color,border:`2px solid ${score.tier_color}`}}>{score.tier_emoji} {score.tier_cn}</div><GaugeSVG score={score.composite} color={score.tier_color}/></div><div className="score-right"><div className="advice-position" style={{color:score.tier_color}}>{advice.position}</div><div className="advice-detail">{advice.position_detail}</div><div className="advice-action">{advice.btc_action}</div><div className="advice-action">{advice.spx_action}</div><div className="advice-action">{advice.nasdaq_action}</div>{advice.key_risk&&<div className="advice-risk">{advice.key_risk}</div>}{advice.key_catalyst&&<div className="advice-catalyst">{advice.key_catalyst}</div>}</div></div>);}

function AssetCards({outlook}){const icons={btc:"â‚¿",spx:"ğŸ“ˆ",nasdaq:"ğŸ’»"};const labels={btc:"Bitcoin",spx:"S&P 500",nasdaq:"çº³æ–¯è¾¾å…‹"};return(<div className="asset-grid">{["btc","spx","nasdaq"].map(k=>{const a=outlook[k];if(!a)return null;return(<div className="asset-card" key={k}><div className="asset-icon">{icons[k]}</div><div className="asset-info"><div className="asset-name">{labels[k]}</div><div className="asset-score-num" style={{color:a.color}}>{Math.round(a.score)}</div><div className="asset-tier-badge" style={{background:a.color+"20",color:a.color,border:`1px solid ${a.color}`}}>{a.tier_cn}</div><div className="asset-note">{a.note}</div></div></div>);})}</div>);}

function ScoreBreakdown({data}){const{indicator_scores,weights,advice}=data;const sorted=Object.entries(indicator_scores).sort((a,b)=>b[1].score-a[1].score);return(<div className="breakdown"><div className="breakdown-title">å„æŒ‡æ ‡è¯„åˆ†æ˜ç»†</div><div className="breakdown-sub">è¯„åˆ†0-100ï¼Œè¶Šé«˜è¶Šåˆ©å¤šé£é™©èµ„äº§ | æƒé‡åŸºäºå®è§‚ç ”ç©¶+å›æµ‹ç›¸å…³æ€§</div>{sorted.map(([name,info])=>(<div className="bar-row" key={name}><div className="bar-label">{IND_NAME[name]||name}<span className="bar-weight">({weights[name]||0}%)</span></div><div className="bar-track"><div className="bar-fill" style={{width:`${info.score}%`,background:info.signal_color}}/></div><div className="bar-val" style={{color:info.signal_color}}>{Math.round(info.score)}</div><div className="bar-signal" style={{color:info.signal_color}}>{info.signal_cn}</div></div>))}<div className="factors"><div><div className="factors-title" style={{color:"#22c55e"}}>åˆ©å¤šå› ç´ </div>{(advice.bullish_factors||[]).map(([n,s,sig],i)=><div className="factor-item" style={{color:"#86efac"}} key={i}>âœ… {IND_NAME[n]||n}ï¼ˆ{Math.round(s)}åˆ† {sig}ï¼‰</div>)}{!(advice.bullish_factors||[]).length&&<div className="factor-item" style={{color:"#475569"}}>æš‚æ— æ˜æ˜¾åˆ©å¤š</div>}</div><div><div className="factors-title" style={{color:"#ef4444"}}>åˆ©ç©ºå› ç´ </div>{(advice.bearish_factors||[]).map(([n,s,sig],i)=><div className="factor-item" style={{color:"#fca5a5"}} key={i}>âš ï¸ {IND_NAME[n]||n}ï¼ˆ{Math.round(s)}åˆ† {sig}ï¼‰</div>)}{!(advice.bearish_factors||[]).length&&<div className="factor-item" style={{color:"#475569"}}>æš‚æ— æ˜æ˜¾åˆ©ç©º</div>}</div></div></div>);}

function JudgmentBox({judgment}){const styles={TIGHTENING:{bg:"#451a1a",border:"#ef4444",icon:"ğŸ”´",color:"#fca5a5"},LOCAL_DISTURBANCE:{bg:"#422006",border:"#f59e0b",icon:"ğŸŸ¡",color:"#fcd34d"},STABLE:{bg:"#052e16",border:"#10b981",icon:"ğŸŸ¢",color:"#86efac"},UNKNOWN:{bg:"#1e293b",border:"#64748b",icon:"âšª",color:"#94a3b8"}};const s=styles[judgment.regime]||styles.UNKNOWN;return(<div className="judgment"><div className="judgment-regime" style={{background:s.bg,border:`1px solid ${s.border}`,color:s.color}}>{s.icon} {judgment.regime_cn||"?"}</div><div className="judgment-text">{judgment.explanation}</div><div className="judgment-tags"><span className="judgment-tag">å‡€æµåŠ¨æ€§èµ°å¼±: <b>{judgment.net_liquidity_weakening?"æ˜¯":"å¦"}</b></span><span className="judgment-tag">ç¡®è®¤ç»´åº¦: <b>{judgment.stress_count||0}</b>ä¸ª</span><span className="judgment-tag">é£é™©èµ„äº§ç¡®è®¤: <b>{judgment.risk_asset_confirming?"æ˜¯":"å¦"}</b></span></div></div>);}

function SummaryTable({readings,changes}){return(<div className="table-wrap"><table><thead><tr><th>æŒ‡æ ‡</th><th style={{textAlign:"right"}}>æœ€æ–°å€¼</th><th style={{textAlign:"right"}}>5æ—¥å˜åŠ¨</th><th style={{textAlign:"center"}}>Z-Score</th><th style={{textAlign:"center"}}>åˆ†ä½</th><th style={{textAlign:"center"}}>ä¿¡å·</th></tr></thead><tbody>{METRIC_DEFS.map(([key,label,unit,dec])=>{const r=readings[key]||{};const c=changes[key]||{};const val=r.value;const valStr=val!=null?Number(val).toLocaleString(undefined,{minimumFractionDigits:dec,maximumFractionDigits:dec})+unit:"N/A";const chg5=PCT_IND.has(key)&&c.pct_5d!=null?c.pct_5d:c.chg_5d;let chgStr="N/A",chgColor="#64748b";if(chg5!=null){chgStr=PCT_IND.has(key)&&c.pct_5d!=null?(c.pct_5d*100).toFixed(1)+"%":Number(chg5).toFixed(2);if(chg5>0)chgStr="+"+chgStr;chgColor=BAD_WHEN_UP.has(key)?(chg5>0?"#fca5a5":chg5<0?"#86efac":"#64748b"):(chg5<0?"#fca5a5":chg5>0?"#86efac":"#64748b");}const zs=r.zscore;const zsStr=typeof zs==="number"?(zs>=0?"+":"")+zs.toFixed(2):"N/A";const pctl=r.percentile;const pctlStr=pctl!=null?Math.round(pctl*100)+"%":"N/A";return(<tr key={key}><td style={{fontWeight:600}}>{label}</td><td className="num">{valStr}</td><td className="num" style={{color:chgColor,fontWeight:600}}>{chgStr}</td><td style={{textAlign:"center"}}>{zsStr}</td><td style={{textAlign:"center"}}>{pctlStr}</td><td style={{textAlign:"center"}}><SignalBadge sig={r.signal||"NEUTRAL"}/></td></tr>);})}</tbody></table></div>);}

function IndicatorSection({secKey,idx,readings,changes,charts}){const kb=KNOWLEDGE[secKey];if(!kb)return null;const chartB64=charts[kb.chart];if(!chartB64)return null;const dataKey=DATA_KEY_MAP[secKey]||secKey;const r=readings[dataKey]||{};const val=r.value;let vd="N/A";if(val!=null){if(["spx","btc"].includes(dataKey))vd=Math.round(val).toLocaleString();else if(["sofr","hy_oas"].includes(dataKey))vd=Number(val).toFixed(4)+"%";else if(dataKey==="net_liquidity")vd=Number(val).toFixed(1)+"B";else if(["carry_spread_bps","curve_slope_bps"].includes(dataKey))vd=Math.round(val)+" bps";else vd=Number(val).toFixed(2);}return(<div className="indicator" id={`sec-${secKey}`}><div className="indicator-header"><div className="indicator-num">{idx}</div><div><div className="indicator-title">{kb.title}</div><div className="indicator-val">å½“å‰: <b>{vd}</b> <SignalBadge sig={r.signal||"NEUTRAL"}/></div></div></div><div className="indicator-chart"><img src={`data:image/png;base64,${chartB64}`} alt={kb.title}/></div><div className="explain-what"><div className="explain-label">è¿™æ˜¯ä»€ä¹ˆ</div><div className="explain-text">{kb.what}</div></div><div className="explain-grid"><div className="explain-good"><div className="explain-label">â–² åé«˜æ„å‘³ç€</div><div className="explain-text">{kb.high}</div></div><div className="explain-bad"><div className="explain-label">â–¼ åä½æ„å‘³ç€</div><div className="explain-text">{kb.low}</div></div></div></div>);}

function QualityTable({quality}){return(<div className="quality"><table><thead><tr><th>æŒ‡æ ‡</th><th>çŠ¶æ€</th><th>è¦†ç›–ç‡</th><th>æ»å(å¤©)</th><th>æœ€åæœ‰æ•ˆæ—¥</th></tr></thead><tbody>{Object.entries(quality).filter(([k,v])=>typeof v==="object").map(([k,v])=>(<tr key={k}><td>{k}</td><td><span style={{color:v.status==="ok"?"#86efac":"#fcd34d"}}>â—</span> {v.status}</td><td>{Math.round((v.coverage||0)*100)}%</td><td>{v.stale_days||0}</td><td>{v.last_valid||"N/A"}</td></tr>))}</tbody></table></div>);}

// ============================================================
// FORWARD ANALYSIS COMPONENTS (å‰ç»æ€§åˆ†æ)
// ============================================================
const FWD_IND_NAME={"net_liquidity":"å‡€æµåŠ¨æ€§","vix":"VIX","hy_oas":"é«˜æ”¶ç›Šåˆ©å·®","sofr":"SOFR","dxy":"ç¾å…ƒæŒ‡æ•°","carry_spread_bps":"å¥—æ¯åˆ©å·®","curve_slope_bps":"æ›²çº¿æ–œç‡","on_rrp":"é€†å›è´­"};

function TrendArrow({dir,momentum,improving}){
  const arrows={"rising":"â†‘","falling":"â†“","sideways":"â†’"};
  const colors={true:"#22c55e",false:"#ef4444"};
  const momentumIcon=momentum==="accelerating"?"âš¡":momentum==="decelerating"?"ğŸ”»":"â–";
  return(<span style={{display:"inline-flex",alignItems:"center",gap:4}}>
    <span style={{fontSize:18,color:colors[improving]}}>{arrows[dir]||"â†’"}</span>
    <span style={{fontSize:11}} title={`åŠ¨é‡: ${momentum}`}>{momentumIcon}</span>
  </span>);
}

function TrendPanel({trends}){
  if(!trends||!Object.keys(trends).length) return null;
  const entries=Object.entries(trends).sort((a,b)=>Math.abs(b[1].chg_5d_pct)-Math.abs(a[1].chg_5d_pct));
  return(<div className="fwd-panel">
    <div className="fwd-title">ğŸ“Š æŒ‡æ ‡è¶‹åŠ¿åŠ¨é‡</div>
    <div className="fwd-subtitle">æ–¹å‘ + é€Ÿåº¦å˜åŒ– + æ˜¯å¦æœ‰åˆ©é£é™©èµ„äº§</div>
    <div className="trend-grid">
      {entries.map(([k,t])=>(<div className="trend-card" key={k} style={{borderLeft:`3px solid ${t.is_improving?"#22c55e":"#ef4444"}`}}>
        <div className="trend-name">{FWD_IND_NAME[k]||k}</div>
        <div className="trend-dir">
          <TrendArrow dir={t.direction} momentum={t.momentum_signal} improving={t.is_improving}/>
          <span className="trend-label" style={{color:t.is_improving?"#86efac":"#fca5a5"}}>{t.direction_cn} Â· {t.momentum_signal_cn}</span>
        </div>
        <div className="trend-nums">
          <span style={{color:t.chg_5d_pct>0?"#86efac":t.chg_5d_pct<0?"#fca5a5":"#94a3b8"}}>5æ—¥ {t.chg_5d_pct>0?"+":""}{t.chg_5d_pct}%</span>
          <span style={{color:t.chg_20d_pct>0?"#86efac":t.chg_20d_pct<0?"#fca5a5":"#94a3b8",marginLeft:12}}>20æ—¥ {t.chg_20d_pct>0?"+":""}{t.chg_20d_pct}%</span>
        </div>
        <div className="trend-verdict" style={{color:t.is_improving?"#86efac":"#fca5a5"}}>{t.is_improving_cn}</div>
      </div>))}
    </div>
  </div>);
}

function AnalogueTable({analogues,fwdStats}){
  if(!analogues||!analogues.length) return(<div className="fwd-panel"><div className="fwd-title">ğŸ” å†å²ç±»æ¯”</div><div className="fwd-empty">å†å²æ•°æ®ä¸è¶³ï¼Œæš‚æ— å¯æ¯”è¾ƒçš„ç±»ä¼¼ç¯å¢ƒ</div></div>);
  return(<div className="fwd-panel">
    <div className="fwd-title">ğŸ” å†å²ç±»æ¯” â€” ç›¸ä¼¼å®è§‚ç¯å¢ƒä¸‹å¸‚åœºè¡¨ç°</div>
    <div className="fwd-subtitle">åŸºäºå„æŒ‡æ ‡Z-Scoreå‘é‡ä½™å¼¦ç›¸ä¼¼åº¦åŒ¹é… | ç›¸ä¼¼åº¦â‰¥0.7</div>
    <div className="table-wrap" style={{marginTop:12}}>
      <table>
        <thead><tr><th>æ—¥æœŸ</th><th style={{textAlign:"center"}}>ç›¸ä¼¼åº¦</th><th style={{textAlign:"right"}}>SPX +5æ—¥</th><th style={{textAlign:"right"}}>SPX +20æ—¥</th><th style={{textAlign:"right"}}>BTC +5æ—¥</th><th style={{textAlign:"right"}}>BTC +20æ—¥</th></tr></thead>
        <tbody>
          {analogues.slice(0,8).map((a,i)=>(<tr key={i}>
            <td style={{fontWeight:600}}>{a.date}</td>
            <td style={{textAlign:"center"}}><span className="sim-badge">{(a.similarity*100).toFixed(0)}%</span></td>
            <td className="num" style={{color:a.spx_fwd_5d>0?"#86efac":a.spx_fwd_5d<0?"#fca5a5":"#94a3b8"}}>{a.spx_fwd_5d!=null?(a.spx_fwd_5d>0?"+":"")+a.spx_fwd_5d+"%":"N/A"}</td>
            <td className="num" style={{color:a.spx_fwd_20d>0?"#86efac":a.spx_fwd_20d<0?"#fca5a5":"#94a3b8",fontWeight:700}}>{a.spx_fwd_20d!=null?(a.spx_fwd_20d>0?"+":"")+a.spx_fwd_20d+"%":"N/A"}</td>
            <td className="num" style={{color:a.btc_fwd_5d>0?"#86efac":a.btc_fwd_5d<0?"#fca5a5":"#94a3b8"}}>{a.btc_fwd_5d!=null?(a.btc_fwd_5d>0?"+":"")+a.btc_fwd_5d+"%":"N/A"}</td>
            <td className="num" style={{color:a.btc_fwd_20d>0?"#86efac":a.btc_fwd_20d<0?"#fca5a5":"#94a3b8",fontWeight:700}}>{a.btc_fwd_20d!=null?(a.btc_fwd_20d>0?"+":"")+a.btc_fwd_20d+"%":"N/A"}</td>
          </tr>))}
        </tbody>
      </table>
    </div>
    {fwdStats&&fwdStats.n_analogues>0&&(<div className="analogue-stats">
      <div className="stat-row"><span className="stat-label">ğŸ“ˆ SPX 20æ—¥é¢„æœŸ</span><span className="stat-val">ä¸­ä½æ•° <b style={{color:fwdStats.spx_median_20d>0?"#86efac":"#fca5a5"}}>{fwdStats.spx_median_20d>0?"+":""}{fwdStats.spx_median_20d}%</b>ã€€åŒºé—´ [{fwdStats.spx_p25_20d}%, {fwdStats.spx_p75_20d}%]ã€€èƒœç‡ {fwdStats.win_rate_spx_20d!=null?Math.round(fwdStats.win_rate_spx_20d*100)+"%":"N/A"}</span></div>
      <div className="stat-row"><span className="stat-label">â‚¿ BTC 20æ—¥é¢„æœŸ</span><span className="stat-val">ä¸­ä½æ•° <b style={{color:fwdStats.btc_median_20d>0?"#86efac":"#fca5a5"}}>{fwdStats.btc_median_20d>0?"+":""}{fwdStats.btc_median_20d}%</b>ã€€åŒºé—´ [{fwdStats.btc_p25_20d}%, {fwdStats.btc_p75_20d}%]ã€€èƒœç‡ {fwdStats.win_rate_btc_20d!=null?Math.round(fwdStats.win_rate_btc_20d*100)+"%":"N/A"}</span></div>
    </div>)}
  </div>);
}

function ForwardSignalHero({signal,regime}){
  if(!signal) return null;
  const biasColors={"bullish":"#22c55e","mild_bull":"#86efac","neutral":"#eab308","mild_bear":"#fca5a5","bearish":"#ef4444"};
  const color=biasColors[signal.bias]||"#94a3b8";
  return(<div className="fwd-signal-hero" style={{borderColor:color}}>
    <div className="fwd-signal-left">
      <div className="fwd-signal-label">å‰ç»ç»¼åˆä¿¡å·</div>
      <div className="fwd-signal-score" style={{color}}>{Math.round(signal.score)}</div>
      <div className="fwd-signal-bias" style={{background:color+"20",color,border:`1px solid ${color}`}}>{signal.bias_cn}</div>
      <div className="fwd-signal-detail" style={{marginTop:8,fontSize:12,color:"#94a3b8"}}>
        å½“å‰è¯„åˆ†Ã—40% + è¶‹åŠ¿åŠ¨é‡Ã—30% + å†å²ç±»æ¯”Ã—30%
      </div>
    </div>
    <div className="fwd-signal-right">
      <div className="fwd-comp">
        <div className="fwd-comp-item"><span className="fwd-comp-label">å½“å‰è¯„åˆ†</span><div className="fwd-comp-bar"><div style={{width:`${signal.components.current_score}%`,background:"#3b82f6"}}/></div><span className="fwd-comp-val">{Math.round(signal.components.current_score)}</span></div>
        <div className="fwd-comp-item"><span className="fwd-comp-label">è¶‹åŠ¿åŠ¨é‡</span><div className="fwd-comp-bar"><div style={{width:`${signal.components.momentum_score}%`,background:signal.components.momentum_score>=50?"#22c55e":"#ef4444"}}/></div><span className="fwd-comp-val">{Math.round(signal.components.momentum_score)}</span></div>
        <div className="fwd-comp-item"><span className="fwd-comp-label">å†å²ç±»æ¯”</span><div className="fwd-comp-bar"><div style={{width:`${signal.components.historical_score}%`,background:signal.components.historical_score>=50?"#22c55e":"#ef4444"}}/></div><span className="fwd-comp-val">{Math.round(signal.components.historical_score)}</span></div>
      </div>
      <div style={{marginTop:12,fontSize:12,color:"#94a3b8"}}>{signal.improving_count}/{signal.total_indicators} ä¸ªæŒ‡æ ‡è¾¹é™…æ”¹å–„ä¸­</div>
      {regime&&(<div className="regime-probs" style={{marginTop:12}}>
        <span className="regime-prob" style={{color:"#ef4444"}}>æ¶åŒ– {Math.round(regime.worsen_prob*100)}%</span>
        <span className="regime-prob" style={{color:"#eab308"}}>ç»´æŒ {Math.round(regime.stay_prob*100)}%</span>
        <span className="regime-prob" style={{color:"#22c55e"}}>æ”¹å–„ {Math.round(regime.improve_prob*100)}%</span>
      </div>)}
    </div>
  </div>);
}

function ForwardNarrative({text}){
  if(!text) return null;
  // Split by paragraphs for clean rendering
  const paragraphs=text.split(/\n\n+/).filter(p=>p.trim());
  return(<div className="fwd-narrative">
    <div className="fwd-title">ğŸ§  AI å‰ç»ç ”åˆ¤</div>
    <div className="narrative-body">
      {paragraphs.map((p,i)=>(<p key={i} className="narrative-para">{p.trim()}</p>))}
    </div>
    <div className="narrative-disclaimer">ä»¥ä¸Šç”±AIåŸºäºé‡åŒ–ä¿¡å·ç”Ÿæˆï¼Œä»…ä¾›å‚è€ƒï¼Œä¸æ„æˆæŠ•èµ„å»ºè®®</div>
  </div>);
}

function ForwardAnalysisSection({fwd}){
  if(!fwd) return(<div className="fwd-empty-section"><div className="section-divider">ğŸ”® å‰ç»åˆ†æ</div><div className="fwd-panel" style={{textAlign:"center",padding:32,color:"#64748b"}}>å‰ç»åˆ†ææ•°æ®å°šæœªç”Ÿæˆã€‚è¿è¡Œå®Œæ•´ pipeline åå¯ç”¨ã€‚</div></div>);
  return(<div>
    <div className="section-divider">ğŸ”® å‰ç»åˆ†æ â€” è¶‹åŠ¿ Â· å›æµ‹ Â· é¢„åˆ¤</div>
    <ForwardSignalHero signal={fwd.forward_signal} regime={fwd.regime_outlook}/>
    <ForwardNarrative text={fwd.ai_narrative}/>
    <TrendPanel trends={fwd.trend_summary}/>
    <AnalogueTable analogues={fwd.historical_analogues} fwdStats={fwd.forward_return_stats}/>
  </div>);
}

function MacroDashboardTab({data}){
  const meta=data.meta||{};const reportDate=meta.report_date||"";const genTime=(data.generated_at||"").slice(0,19);
  return(<div>
    <div className="header"><div><h1>å®è§‚æµåŠ¨æ€§ä»ªè¡¨ç›˜</h1><div className="header-meta">{reportDate}<span className="header-badge">æ›´æ–°äº {genTime}</span><span className="header-badge">{meta.data_range?.trading_days||0} äº¤æ˜“æ—¥</span></div></div></div>
    <ScoreHero data={data}/>
    <AssetCards outlook={data.asset_outlook||{}}/>
    <ScoreBreakdown data={data}/>
    <div className="note" style={{marginBottom:24}}>è¯„åˆ†æ–¹æ³•ï¼šæ¯ä¸ªæŒ‡æ ‡ç»¼åˆã€Œå½“å‰åˆ†ä½(40%)+è¿‘æœŸè¶‹åŠ¿(35%)+Z-Scoreåç¦»åº¦(25%)ã€è®¡ç®—0-100åˆ†ã€‚æƒé‡æ¥è‡ªå®è§‚é‡‘èç ”ç©¶ã€‚BTCå¯¹æµåŠ¨æ€§betaçº¦1.5xï¼Œçº³æ–¯è¾¾å…‹çº¦1.05xï¼Œæ ‡æ™®500çº¦0.9xã€‚æœ¬è¯„åˆ†ä»…ä¾›å‚è€ƒï¼Œä¸æ„æˆæŠ•èµ„å»ºè®®ã€‚</div>
    <ForwardAnalysisSection fwd={data.forward_analysis}/>
    <div className="section-divider">ç»¼åˆç ”åˆ¤</div>
    <JudgmentBox judgment={data.judgment||{}}/>
    <div className="section-divider">æŒ‡æ ‡é€Ÿè§ˆ</div>
    <SummaryTable readings={data.readings||{}} changes={data.changes||{}}/>
    <div className="section-divider">é€é¡¹åˆ†æ</div>
    <div className="nav-bar">{SECTION_ORDER.map(k=>{const kb=KNOWLEDGE[k];return kb?<a className="nav-link" key={k} onClick={()=>document.getElementById(`sec-${k}`)?.scrollIntoView({behavior:"smooth"})}>{kb.title.split("(")[0].trim().split(" ")[0]}</a>:null;})}</div>
    {SECTION_ORDER.map((k,i)=><IndicatorSection key={k} secKey={k} idx={i+1} readings={data.readings||{}} changes={data.changes||{}} charts={data.charts||{}}/>)}
    <div className="section-divider">æ•°æ®æºçŠ¶æ€</div>
    <QualityTable quality={data.quality||{}}/>
  </div>);
}

// ============================================================
// MAIN APP
// ============================================================
function App(){
  const[data,setData]=useState(null);
  const[error,setError]=useState(null);
  const[activeTab,setActiveTab]=useState("brief");

  useEffect(()=>{
    fetch("./data/latest.json")
      .then(r=>{if(!r.ok)throw new Error(`HTTP ${r.status}`);return r.json();})
      .then(setData)
      .catch(e=>setError(e.message));
  },[]);

  if(error) return(<div className="container"><div className="loading"><div style={{fontSize:48}}>âš ï¸</div><div className="loading-text">æ•°æ®åŠ è½½å¤±è´¥: {error}</div><div className="loading-text" style={{fontSize:12}}>è¯·ç¡®è®¤ data/latest.json å­˜åœ¨</div></div></div>);
  if(!data) return(<div className="container"><div className="loading"><div className="loading-spinner"/><div className="loading-text">åŠ è½½æ•°æ®ä¸­...</div></div></div>);

  const brief=data.daily_brief||null;
  const hasBrief=brief&&brief.status!=='error';

  return(
    <div className="container">
      <div className="tab-nav">
        <button className={`tab-btn ${activeTab==="brief"?"active":""}`} onClick={()=>setActiveTab("brief")}>
          æ¯æ—¥åˆ†æ
          {hasBrief&&brief.market?.indices?.length>0&&<span className="tab-indicator">{brief.market.indices.some(i=>(i.change_pct||0)>0)?"ğŸ“ˆ":"ğŸ“‰"}</span>}
        </button>
        <button className={`tab-btn ${activeTab==="macro"?"active":""}`} onClick={()=>setActiveTab("macro")}>
          å®è§‚æµåŠ¨æ€§
          {data.score&&<span className="tab-indicator" style={{color:data.score.tier_color}}>{data.score.tier_emoji}</span>}
        </button>
      </div>
      {activeTab==="brief"&&<DailyBriefTab brief={brief||{status:'unavailable'}}/>}
      {activeTab==="macro"&&<MacroDashboardTab data={data}/>}
      <div className="footer">å®è§‚æµåŠ¨æ€§ä»ªè¡¨ç›˜ | æ•°æ®æº: FRED API + Yahoo Finance + Google News RSS | æ¯æ—¥è‡ªåŠ¨æ›´æ–°<br/>æœ¬æŠ¥å‘Šä»…ä¾›ç ”ç©¶å‚è€ƒï¼Œä¸æ„æˆæŠ•èµ„å»ºè®®ã€‚å¸‚åœºæœ‰é£é™©ï¼ŒæŠ•èµ„éœ€è°¨æ…ã€‚</div>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById("root")).render(<App/>);
</script>
</body>
</html>
